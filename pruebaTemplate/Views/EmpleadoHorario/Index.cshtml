@model IEnumerable<PlanillaPM.Models.EmpleadoHorario>
@using PlanillaPM.Models;

        @{
        ViewData["Title"] = "Index";
    var userPermissions = ViewData["UserPermissions"] as List<string>;
        Pager pager = new Pager();
        int PageNo = 0;
        if (ViewBag.Pager != null)
        {
        pager = ViewBag.Pager;
        PageNo = pager.CurrentPage;
        }
            Layout = "~/Views/Shared/_Layout.cshtml";
        }
        <style>
    .day-cell {
        min-width: 150px;
        max-width: 180px;
        padding: 8px;
        vertical-align: middle !important;
    }
    
    .day-schedule {
        display: flex;
        flex-direction: column;
        font-size: 0.85rem;
        gap: 3px;
    }
    
    .time-range {
        font-weight: 500;
        color: #333;
        display: flex;
        align-items: center;
    }
    
    .recess {
        color: #6c757d;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
    }
    
    .total-hours {
        font-weight: bold;
        color: var(--primary);
        display: flex;
        align-items: center;
        margin-top: 3px;
    }
    
    .table-hover tbody tr:hover {
        background-color: rgba(13, 110, 253, 0.05);
    }
    
    .table thead th {
        vertical-align: middle;
        white-space: nowrap;
        text-align: center;
    }
    
    .badge.rounded-pill {
        padding: 5px 10px;
    }
    
    .align-middle {
        vertical-align: middle !important;
    }
</style>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card card-primary">
                    <div class="card-header" style="background-color: var(--blue);">
                        <h3 class="card-title">Empleado Horario</h3>
                        <div class="card-tools">
                            <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                <i class="fas fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    <div class="form-vertical">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <form id="fSearch" method="post" asp-action="Index">
                                                        <div class="row">
                                                            <div class="col-sm-6 btn-group btn-group-justified" role="group">
                                                                <input type="text" style="width: 300px;" id="inNombre" class="form-control" name="filter" placeholder="Buscar...">
                                                                <button class="btn " style="background-color: var(--blue)" type="submit" class="btn btn-info"><i class="fa fa-search" style="color: white;"></i></button>
                                                            </div>
                                                            <div class="col-sm-6 btn-toolbar" role="toolbar" id="toolbar">
                                                                <div class="btn-group btn-group-justified" role="group">

                                                                    <a asp-action="Index" class="btn " style="background-color: var(--blue);"><i class="fa fa-refresh" style="color: white;"></i></a>
                                                                     @if (userPermissions.Contains("Create"))
                                                                {
                                                                    <a asp-action="Create" class="btn " style="background-color: var(--blue);"><i class="fa fa-plus" style="color: white;"></i></a>

                                                                    <a asp-action="Download" class="btn " style="background-color: var(--blue);"><i class="fa fa-file-excel-o" style="color: white;"></i></a>
                                                                }
                                                            </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row m-1">
                                <div id="resultados" class="table-responsive table-striped table-sm">
                                    <table id="table" cellspacing="0" class="table table-striped projects" data-toggle="table">
    <thead class="thead-light">
        <tr>
            <th>No.</th>
            <th>Acciones</th>
            <th>@Html.DisplayNameFor(model => model.IdEmpleado)</th>
            <th>@Html.DisplayNameFor(model => model.IdHorarioBase)</th>
            <th colspan="1">Lunes</th>
            <th colspan="1">Martes</th>
            <th colspan="1">Miércoles</th>
            <th colspan="1">Jueves</th>
            <th colspan="1">Viernes</th>
            <th colspan="1">Sábado</th>
            <th colspan="1">Domingo</th>
            <th>@Html.DisplayNameFor(model => model.TotalHorasSemana)</th>
            <th>@Html.DisplayNameFor(model => model.Activo)</th>
        </tr>
    </thead>
    <tbody>
        @{
            int count = (pager.CurrentPage * pager.PageSize) - pager.PageSize;
        }
        @foreach (var item in Model)
        {
            count++;
            <tr>
                <td>@count</td>
                <td>
                    <div class="btn-group btn-group-sm" role="group" style="font-size: 12px; padding: 4px;">
                        @if (userPermissions.Contains("Edit"))
                        {
                            <a asp-action="Edit" class="btn" style="background-color: var(--blue)" asp-route-id="@item.IdEmpleadoHorario">
                                <i class="fa fa-pencil" style="color: white;"></i>
                            </a>
                        }
                        @if (userPermissions.Contains("View"))
                        {
                            <a asp-action="Details" class="btn" style="background-color: var(--blue)" asp-route-id="@item.IdEmpleadoHorario">
                                <i class="fa fa-address-card-o" style="color: white;"></i>
                            </a>
                        }
                        @if (userPermissions.Contains("Delete"))
                        {
                            <a asp-action="Delete" class="btn" style="background-color: var(--blue)" asp-route-id="@item.IdEmpleadoHorario">
                                <i class="fa fa-trash-o" style="color: white;"></i>
                            </a>
                        }
                    </div>
                </td>
                <td>@item.IdEmpleadoNavigation.NombreCompleto</td>
                <td>@item.IdHorarioBaseNavigation.NombreHorario</td>

                 <td class="day-cell @(!item.LunDesde.HasValue ? "bg-light" : "")">
                    @if(item.LunDesde.HasValue)
                    {
                        <div class="day-schedule">
                            <div class="time-range">
                                <i class="far fa-clock text-muted me-1"></i>
                                @item.LunDesde?.ToString("hh\\:mm") - @item.LunHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="recess">
                                <i class="fas fa-coffee text-muted me-1"></i>
                                @item.LunRecesoDesde?.ToString("hh\\:mm") - @item.LunRecesoHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="total-hours">
                                <i class="fas fa-check-circle text-primary me-1"></i>
                                @item.HorasLunes hrs
                            </div>
                        </div>
                    }
                </td>
                 <td class="day-cell @(!item.MarDesde.HasValue ? "bg-light" : "")">
                    @if(item.MarDesde.HasValue)
                    {
                        <div class="day-schedule">
                            <div class="time-range">
                                <i class="far fa-clock text-muted me-1"></i>
                                @item.MarDesde?.ToString("hh\\:mm") - @item.MarHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="recess">
                                <i class="fas fa-coffee text-muted me-1"></i>
                                @item.MarRecesoDesde?.ToString("hh\\:mm") - @item.MarRecesoHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="total-hours">
                                <i class="fas fa-check-circle text-primary me-1"></i>
                                @item.HorasMartes hrs
                            </div>
                        </div>
                    }
                </td>
                
              <td class="day-cell @(!item.MieDesde.HasValue ? "bg-light" : "")">
    @if (item.MieDesde.HasValue)
    {
        <div class="day-schedule">
            <div class="time-range">
                <i class="far fa-clock text-muted me-1"></i>
                @item.MieDesde?.ToString("hh\\:mm") - @item.MieHasta?.ToString("hh\\:mm")
            </div>
            <div class="recess">
                <i class="fas fa-coffee text-muted me-1"></i>
                @item.MieRecesoDesde?.ToString("hh\\:mm") - @item.MieRecesoHasta?.ToString("hh\\:mm")
            </div>
            <div class="total-hours">
                <i class="fas fa-check-circle text-primary me-1"></i>
                @item.HorasMiercoles hrs
            </div>
        </div>
    }
</td>
<td class="day-cell @(!item.JueDesde.HasValue ? "bg-light" : "")">
    @if (item.JueDesde.HasValue)
    {
        <div class="day-schedule">
            <div class="time-range">
                <i class="far fa-clock text-muted me-1"></i>
                @item.JueDesde?.ToString("hh\\:mm") - @item.JueHasta?.ToString("hh\\:mm")
            </div>
            <div class="recess">
                <i class="fas fa-coffee text-muted me-1"></i>
                @item.JueRecesoDesde?.ToString("hh\\:mm") - @item.JueRecesoHasta?.ToString("hh\\:mm")
            </div>
            <div class="total-hours">
                <i class="fas fa-check-circle text-primary me-1"></i>
                @item.HorasJueves hrs
            </div>
        </div>
    }
</td>
<td class="day-cell @(!item.VieDesde.HasValue ? "bg-light" : "")">
    @if (item.VieDesde.HasValue)
    {
        <div class="day-schedule">
            <div class="time-range">
                <i class="far fa-clock text-muted me-1"></i>
                @item.VieDesde?.ToString("hh\\:mm") - @item.VieHasta?.ToString("hh\\:mm")
            </div>
            <div class="recess">
                <i class="fas fa-coffee text-muted me-1"></i>
                @item.VieRecesoDesde?.ToString("hh\\:mm") - @item.VieRecesoHasta?.ToString("hh\\:mm")
            </div>
            <div class="total-hours">
                <i class="fas fa-check-circle text-primary me-1"></i>
                @item.HorasViernes hrs
            </div>
        </div>
    }
</td>

               <td class="day-cell @(!item.SabDesde.HasValue ? "bg-light" : "")">
                    @if(item.IndSabado)
                    {
                        <div class="day-schedule">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="badge bg-success">Laborable</span>
                            </div>
                            <div class="time-range">
                                <i class="far fa-clock text-muted me-1"></i>
                                @item.SabDesde?.ToString("hh\\:mm") - @item.SabHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="recess">
                                <i class="fas fa-coffee text-muted me-1"></i>
                                @item.SabRecesoDesde?.ToString("hh\\:mm") - @item.SabRecesoHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="total-hours">
                                <i class="fas fa-check-circle text-primary me-1"></i>
                                @item.HorasSabado hrs
                            </div>
                        </div>
                    }
                    else
                    {
                        <span class="badge bg-secondary">No laborable</span>
                    }
                </td>

                <td class="day-cell @(!item.DomDesde.HasValue ? "bg-light" : "")">
                    @if(item.IndDomingo)
                    {
                        <div class="day-schedule">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="badge bg-success">Laborable</span>
                            </div>
                            <div class="time-range">
                                <i class="far fa-clock text-muted me-1"></i>
                                @item.DomDesde?.ToString("hh\\:mm") - @item.DomHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="recess">
                                <i class="fas fa-coffee text-muted me-1"></i>
                                @item.DomRecesoDesde?.ToString("hh\\:mm") - @item.DomRecesoHasta?.ToString("hh\\:mm")
                            </div>
                            <div class="total-hours">
                                <i class="fas fa-check-circle text-primary me-1"></i>
                                @item.HorasDomingo hrs
                            </div>
                        </div>
                    }
                    else
                    {
                        <span class="badge bg-secondary">No laborable</span>
                    }
                </td>
                <td>@item.TotalHorasSemana</td>
                <td>
                    @if (item.Activo)
                    {
                        <span class="badge badge-success">Activo</span>
                    }
                    else
                    {
                        <span class="badge badge-danger">Inactivo</span>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                    <partial name="_Pager" model="@pager" />
                    </div>
                </div>
            </div>
        </div>
        <br />
    </div>

